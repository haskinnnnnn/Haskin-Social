body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; margin: 0; background: #fff; color: #000; height: 100dvh; display: flex; overflow: hidden; }
.hidden { display: none !important; }
.icon { width: 24px; height: 24px; fill: none; stroke: currentColor; stroke-width: 2; stroke-linecap: round; stroke-linejoin: round; }

/* LAYOUT STRUCTURE */
#app-screen { display: flex; width: 100%; height: 100%; }
.sidebar { width: 260px; background: #f7f9fc; border-right: 1px solid #ddd; padding: 20px; display: flex; flex-direction: column; flex-shrink: 0; overflow-y: auto;}
.main { flex: 1; background: #fff; overflow-y: auto; display: flex; flex-direction: column; height: 100%; padding-bottom: 80px; box-sizing: border-box; position: relative;}
.view { display: none; padding: 15px; padding-bottom: 100px; }
.view.active { display: block; }

/* NAVIGATION */
.nav-item { padding: 12px; margin-bottom: 5px; cursor: pointer; border-radius: 10px; display: flex; align-items: center; gap: 10px; color: #333; transition: 0.2s; }
.nav-item:hover { background: #eee; }
.nav-item.active { background: #e3f2fd; color: #3390ec; font-weight: bold; }
.badge { background: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 10px; margin-left: auto; display: none; }

/* UI COMPONENTS */
.action-btn { padding: 10px 20px; border-radius: 10px; background: #3390ec; color: white; border: none; cursor: pointer; font-weight: bold; display: inline-flex; align-items: center; justify-content: center; gap: 5px; transition: transform 0.1s;}
.action-btn:active { transform: scale(0.95); }
.btn-danger { background: #ff4444; }
.btn-sec { background: #eee; color: black; }
.btn-gold { background: gold; color: black; }
.full-width { width: 100%; margin-top: 5px; }
.sm-btn { padding: 5px 10px; font-size: 12px; }
input, textarea, select { width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 8px; box-sizing: border-box; font-family: inherit; font-size: 14px;}

/* CARDS & POSTS */
.card { border: 1px solid #eee; padding: 15px; border-radius: 12px; margin-bottom: 10px; background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
.user-row { display: flex; align-items: center; gap: 10px; }
.post-img { width: 100%; border-radius: 10px; margin-top: 10px; object-fit: cover; max-height: 500px; }
.post-date { font-size: 12px; color: #888; }

/* --- NEW: MAGAZINE LAYOUT (2-1-2) --- */
.mag-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 5px;
    margin-top: 10px;
    border-radius: 10px;
    overflow: hidden;
}
.mag-item {
    width: 100%;
    aspect-ratio: 1/1; /* Square by default */
    object-fit: cover;
    background: #eee;
    display: block;
}
/* 3rd item is full width (The "1" in 2-1-2) */
.mag-item:nth-child(3) {
    grid-column: span 2;
    aspect-ratio: 16/9;
}
.mag-caption {
    font-size: 12px;
    color: #555;
    margin-top: 2px;
    margin-bottom: 8px;
    display: block;
}

/* --- NEW: ACTION BUTTON IN POST --- */
.action-btn-link { 
    display: block; 
    width: 100%; 
    padding: 12px; 
    margin-top: 10px; 
    background: linear-gradient(90deg, #e3f2fd 0%, #ffffff 100%); 
    color: #3390ec; 
    text-align: center; 
    text-decoration: none; 
    border-radius: 8px; 
    font-weight: bold; 
    border: 1px solid #3390ec; 
    box-sizing: border-box;
    text-transform: uppercase;
    letter-spacing: 1px;
}
.action-btn-link:hover { background: #3390ec; color: white; }

/* AVATAR & SATELLITES */
.avatar-wrap { position: relative; display: inline-block; width: fit-content; height: fit-content; flex-shrink: 0; }
.avatar { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; border: 2px solid transparent; display: block; background: #ddd;}
.av-80 { width: 80px; height: 80px; } 
.sat-icon { position: absolute; font-size: 14px; z-index: 5; pointer-events: none; line-height: 1; filter: drop-shadow(0 0 2px white); }
.av-80 + .sat-icon { font-size: 24px; }
.sat-1 { top: -2px; right: -2px; }
.sat-2 { bottom: -2px; left: -2px; }
.frame-legendary { border-color: gold; box-shadow: 0 0 5px gold; }
.frame-epic { border-color: #d533ff; box-shadow: 0 0 4px #d533ff; }

/* GAME UI */
#game-ui { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #444; z-index: 5000; display: flex; flex-direction: column; }
.game-top-area { flex: 6; background: #5a5a5a; display: flex; align-items: center; justify-content: center; position: relative; border-radius: 0 0 30px 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.5); }
.game-bottom-area { flex: 4; background: linear-gradient(180deg, #d533ff 0%, #a100ff 100%); display: flex; align-items: center; justify-content: center; }
.game-timer-wrap { position: relative; width: 220px; height: 220px; }
.timer-svg { transform: rotate(-90deg); width: 100%; height: 100%; }
.timer-bg { fill: none; stroke: rgba(0,0,0,0.3); stroke-width: 12; }
.timer-progress { fill: none; stroke: #0f0; stroke-width: 12; stroke-dasharray: 283; stroke-dashoffset: 0; transition: 1s linear; }
.game-center-num { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 80px; color: black; font-weight: bold; }
.game-labels { position: absolute; width: 280px; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; }
.lbl-timer { position: absolute; bottom: 10px; right: 0; color: white; font-weight: bold; }
.lbl-num { position: absolute; top: 10px; right: 0; color: white; font-weight: bold; }
.game-buttons { display: flex; gap: 20px; width: 90%; }
.game-btn { flex: 1; height: 60px; border-radius: 12px; font-size: 20px; font-weight: bold; cursor: pointer; border: none; display: flex; align-items: center; justify-content: center; gap: 10px; }
.btn-less { background: #ff4444; color: white; }
.btn-more { background: #00ff00; color: black; }
.game-arrow-down { width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-top: 10px solid white; }
.game-arrow-up { width: 0; height: 0; border-left: 8px solid transparent; border-right: 8px solid transparent; border-bottom: 10px solid black; }

#game-result { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 6000; display: flex; align-items: center; justify-content: center; color: white; text-align: center; }
.result-box { background: #333; padding: 30px; border-radius: 20px; border: 2px solid #555; text-align: center; }
/* CHAT ROOM */
.full-screen-view { position: fixed !important; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 2000; display: flex; flex-direction: column; }
.chat-header { padding: 10px; background: #fff; border-bottom: 1px solid #eee; display: flex; align-items: center; height: 50px; gap: 10px; flex-shrink: 0; z-index: 10; }
.msg-area { flex: 1; overflow-y: auto; padding: 10px; display: flex; flex-direction: column; gap: 10px; z-index: 5; position: relative;}
.chat-input-bar { padding: 10px; border-top: 1px solid #eee; display: flex; gap: 10px; background: #fff; flex-shrink: 0; padding-bottom: max(10px, env(safe-area-inset-bottom)); z-index: 10; }
.msg { padding: 10px; border-radius: 10px; max-width: 70%; word-wrap: break-word; }
.msg.me { align-self: flex-end; background: #e3f2fd; }
.msg.other { align-self: flex-start; background: #f1f1f1; }
.msg.game { align-self: center; background: #d533ff; color: white; text-align: center; cursor: pointer; width: 100%; border: 2px solid white; box-shadow: 0 4px 10px rgba(213, 51, 255, 0.4); }
.chat-img { max-width: 200px; border-radius: 10px; display: block; }
.chat-info { flex: 1; display: flex; flex-direction: column; justify-content: center; cursor: pointer; }
.sub-text { font-size: 10px; color: #888; }

/* --- NEW: CHAT DECOR LAYERS --- */
.chat-bg-layer {
    position: absolute; top: 50px; left: 0; right: 0; bottom: 60px; /* Between header and input */
    z-index: 1; pointer-events: none;
    background-size: cover; background-position: center;
}
.chat-fx-layer {
    position: absolute; top: 50px; left: 0; right: 0; bottom: 60px;
    z-index: 2; pointer-events: none;
    background-size: contain;
}

/* MODALS */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 3000; display: flex; justify-content: center; align-items: center; backdrop-filter: blur(2px); }
.modal { background: white; padding: 20px; border-radius: 15px; width: 90%; max-width: 400px; max-height: 80vh; overflow-y: auto; display: flex; flex-direction: column; position: relative; animation: modalPop 0.2s ease-out; }
@keyframes modalPop { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }
.modal-head { display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 15px; font-size: 1.2em; border-bottom: 1px solid #eee; padding-bottom: 10px; }
.full-height-modal { height: 90%; }
.full-screen-modal { width: 100%; height: 100%; max-width: none; max-height: none; border-radius: 0; }

.fab { position: fixed; bottom: 80px; right: 20px; width: 60px; height: 60px; background: #3390ec; border-radius: 50%; color: white; display: flex; justify-content: center; align-items: center; font-size: 30px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); cursor: pointer; z-index: 1000; transition: transform 0.2s; }
.fab:active { transform: scale(0.9); }
.accordion { background: #f5f5f5; padding: 12px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 10px; border: 1px solid #eee; display: flex; justify-content: space-between; align-items: center; }
.accordion:after { content: 'â–¼'; font-size: 10px; }

/* --- NEW: CANVAS GRAFFITI UI --- */
.canvas-wrapper { 
    flex: 1; 
    display: flex; 
    align-items: center; 
    justify-content: center; 
    background: #333; 
    border: 2px dashed #555; 
    margin: 10px 0; 
    overflow: hidden; 
    touch-action: none; /* Prevent scroll while drawing */
}
#graffiti-canvas { background: white; cursor: crosshair; }
#palette-controls { display: flex; gap: 10px; justify-content: center; margin-bottom: 10px; }
.color-swatch { width: 30px; height: 30px; border-radius: 50%; border: 2px solid #fff; cursor: pointer; }
.color-swatch.gold { background: radial-gradient(circle, #ffd700, #b8860b); }
.color-swatch.red { background: red; }
.color-swatch.blue { background: blue; }
.color-swatch.black { background: black; }

/* MARKET GRID & ITEMS */
.market-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px; }
.market-item { 
    text-align: center; cursor: pointer; 
    border: 1px solid #eee; padding: 10px; 
    border-radius: 10px; display: flex; 
    flex-direction: column; justify-content: center; 
    height: 100px; position: relative;
    background: #fff;
    transition: transform 0.1s;
}
.market-item:active { transform: scale(0.98); }
.item-qty { position: absolute; top: 5px; right: 5px; background: #333; color: white; border-radius: 50%; width: 20px; height: 20px; font-size: 10px; display: flex; align-items: center; justify-content: center; }

/* RARITY COLORS (Borders/Glows) */
.rarity-common { border-color: #ccc; }
.rarity-rare { border-color: #3390ec; box-shadow: 0 0 5px rgba(51, 144, 236, 0.2); }
.rarity-epic { border-color: #d533ff; box-shadow: 0 0 5px rgba(213, 51, 255, 0.3); }
.rarity-legendary { border-color: gold; box-shadow: 0 0 8px gold; }
.rarity-mythical { border-color: red; box-shadow: 0 0 10px red; animation: pulse 2s infinite; }

@keyframes pulse { 0% { box-shadow: 0 0 5px red; } 50% { box-shadow: 0 0 15px red; } 100% { box-shadow: 0 0 5px red; } }

/* TABS */
.tabs { display: flex; gap: 5px; margin-bottom: 10px; overflow-x: auto; padding-bottom: 5px; }
.tab { flex: 1; padding: 8px; border: none; background: #eee; border-radius: 8px; cursor: pointer; font-weight: bold; white-space: nowrap; }
.tab.active { background: #333; color: white; }

/* MOBILE ADJUSTMENTS */
@media (max-width: 768px) {
    .sidebar { position: fixed; bottom: 0; left: 0; width: 100%; height: 60px; flex-direction: row; justify-content: space-around; border-top: 1px solid #ddd; padding: 0; z-index: 100; align-items: center; background: #fff;}
    .desk-label { display: none; }
    .fab { bottom: 70px; }
    .main { padding-bottom: 70px; }
    .nav-item { flex-direction: column; gap: 2px; font-size: 10px; padding: 5px; margin: 0; background: none !important; border-radius: 0; width: 100%; justify-content: center;}
    .nav-item.active { color: #3390ec; }
    .view { padding-bottom: 80px; }
}

<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Haskin</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="splash"><div class="splash-logo">Haskin</div></div>

<div id="auth-screen">
    <div class="auth-box" id="login-box">
        <h1 class="logo-text">–í—Ö–æ–¥</h1>
        <input type="text" id="login-user" placeholder="–Æ–∑–µ—Ä–Ω–µ–π–º">
        <div class="password-wrapper">
            <input type="password" id="login-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <span class="toggle-pass" onclick="window.ui.togglePass('login-pass')">üëÅÔ∏è</span>
        </div>
        <button class="action-btn full-width" onclick="window.app.login()">–í–æ–π—Ç–∏</button>
        <p class="link-text" onclick="window.ui.toggleAuth('reg')">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞?</p>
    </div>

    <div class="auth-box hidden" id="reg-box">
        <h1 class="logo-text">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h1>
        <input type="text" id="reg-user" placeholder="–Æ–∑–µ—Ä–Ω–µ–π–º (–∞–Ω–≥–ª)">
        <input type="text" id="reg-name" placeholder="–ò–º—è">
        <div class="password-wrapper">
            <input type="password" id="reg-pass" placeholder="–ü–∞—Ä–æ–ª—å">
            <span class="toggle-pass" onclick="window.ui.togglePass('reg-pass')">üëÅÔ∏è</span>
        </div>
        <div class="password-wrapper">
            <input type="password" id="reg-pass2" placeholder="–ü–æ–≤—Ç–æ—Ä –ø–∞—Ä–æ–ª—è">
            <span class="toggle-pass" onclick="window.ui.togglePass('reg-pass2')">üëÅÔ∏è</span>
        </div>
        <div class="captcha-box">
            <small>–ö–∞–ø—á–∞: <span id="captcha-task"></span></small>
            <input type="number" id="reg-captcha" placeholder="–û—Ç–≤–µ—Ç">
        </div>
        <button class="action-btn full-width" onclick="window.app.register()">–°–æ–∑–¥–∞—Ç—å</button>
        <p class="link-text" onclick="window.ui.toggleAuth('login')">–ù–∞–∑–∞–¥</p>
    </div>
</div>

<div id="game-ui" class="hidden">
    <div class="game-top-area">
        <div class="game-timer-wrap">
            <svg class="timer-svg" viewBox="0 0 100 100">
                <circle class="timer-bg" cx="50" cy="50" r="45"></circle>
                <circle id="timer-progress" class="timer-progress" cx="50" cy="50" r="45"></circle>
            </svg>
            <div id="game-hint-num" class="game-center-num">00</div>
        </div>
        <div class="game-labels">
            <span class="lbl-timer">–¢–∞–π–º–µ—Ä</span>
            <span class="lbl-num">–ß–∏—Å–ª–æ</span>
        </div>
    </div>
    <div class="game-bottom-area">
        <div class="game-buttons">
            <button class="game-btn btn-less" onclick="window.game.makeGuess('less')">
                <div class="game-arrow-down"></div> –ú–µ–Ω—å—à–µ
            </button>
            <button class="game-btn btn-more" onclick="window.game.makeGuess('more')">
                <div class="game-arrow-up"></div> –ë–æ–ª—å—à–µ
            </button>
        </div>
    </div>
</div>

<div id="game-result" class="hidden">
    <div class="result-box">
        <h1 id="gr-title">–ü–û–ë–ï–î–ê</h1>
        <div id="gr-emoji">üòé</div>
        <p>–ë—ã–ª–æ: <b id="gr-real">0</b></p>
        <p id="gr-msg"></p>
        <button class="action-btn" onclick="window.game.close()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
</div>

<div id="create-post-modal" class="modal-overlay hidden">
    <div class="modal">
        <div class="modal-head">–ù–æ–≤—ã–π –ø–æ—Å—Ç <span onclick="window.ui.closeModals()" class="close-btn">√ó</span></div>
        <p id="group-post-hint" class="hint-text hidden"></p>
        <textarea id="post-text" rows="4" placeholder="–ß—Ç–æ –Ω–æ–≤–æ–≥–æ?"></textarea>
        <div id="post-img-preview" class="hidden img-preview-box">
            <img id="preview-img-el">
            <div onclick="window.app.clearImg()" class="remove-img-btn">√ó</div>
        </div>
        <div class="modal-footer">
            <label class="action-btn btn-sec">üì∑<input type="file" hidden accept="image/*" onchange="window.app.handleImg(this)"></label>
            <button class="action-btn" onclick="window.app.createPost()">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
        </div>
    </div>
</div>

<div id="case-modal" class="modal-overlay hidden">
    <div class="modal center-content">
        <h3>–û—Ç–∫—Ä—ã—Ç–∏–µ...</h3>
        <div id="case-spinner" class="case-anim">üì¶</div>
        <div id="case-result" class="hidden"></div>
        <button class="action-btn hidden" id="case-close-btn" onclick="window.ui.closeModals()">–ó–∞–±—Ä–∞—Ç—å</button>
    </div>
</div>

<div id="sell-modal" class="modal-overlay hidden">
    <div class="modal">
        <div class="modal-head">–ü—Ä–µ–¥–º–µ—Ç <span id="sell-emoji-preview"></span> <span onclick="window.ui.closeModals()" class="close-btn">√ó</span></div>
        <div class="card mb-20">
            <h4>üìå –ó–∞–∫—Ä–µ–ø–∏—Ç—å</h4>
            <div style="display:flex; gap:10px;">
                <button class="action-btn full-width btn-sec" onclick="window.market.pinItem('slot1')">–°–ª–æ—Ç 1 (‚Üó)</button>
                <button class="action-btn full-width btn-sec" onclick="window.market.pinItem('slot2')">–°–ª–æ—Ç 2 (‚Üô)</button>
            </div>
            <button class="action-btn full-width btn-danger mt-10" onclick="window.market.unpinItem()">–û—Ç–∫—Ä–µ–ø–∏—Ç—å –≤—Å–µ</button>
        </div>
        <div class="card">
            <h4>üí∞ –ü—Ä–æ–¥–∞—Ç—å</h4>
            <input type="number" id="sell-price" placeholder="–¶–µ–Ω–∞ (HC)">
            <input type="hidden" id="sell-item-id">
            <input type="hidden" id="sell-item-emoji">
            <input type="hidden" id="sell-item-rarity">
            <button class="action-btn full-width" onclick="window.market.confirmSell()">–í—ã—Å—Ç–∞–≤–∏—Ç—å</button>
        </div>
    </div>
</div>

<div id="buy-modal" class="modal-overlay hidden">
    <div class="modal center-content">
        <div class="modal-head">–õ–æ—Ç <span onclick="window.ui.closeModals()" class="close-btn">√ó</span></div>
        <div id="buy-emoji-display" style="font-size: 80px; margin: 10px 0;"></div>
        <h2 id="buy-price-display" style="color:var(--gold-color)"></h2>
        <div class="user-row center-content" style="justify-content:center; margin:10px 0;">
            –ü—Ä–æ–¥–∞–≤–µ—Ü: <b id="buy-seller-display"></b>
        </div>
        <input type="hidden" id="buy-doc-id">
        <input type="hidden" id="buy-item-price">
        <input type="hidden" id="buy-item-seller">
        <input type="hidden" id="buy-item-emoji">
        <input type="hidden" id="buy-item-rarity">
        <input type="hidden" id="buy-item-realid">
        <button class="action-btn full-width" id="buy-btn-action">–ö–£–ü–ò–¢–¨</button>
    </div>
</div>

<div id="game-create-modal" class="modal-overlay hidden">
    <div class="modal">
        <div class="modal-head">–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä—É <span onclick="window.ui.closeModals()" class="close-btn">√ó</span></div>
        <p>–ß–∏—Å–ª–æ (1-100):</p>
        <input type="number" id="game-number">
        <p>–°—Ç–∞–≤–∫–∞ (HC):</p>
        <input type="number" id="game-bet">
        <button class="action-btn full-width" onclick="window.game.create()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
    </div>
</div>

<div id="app-screen" class="hidden">
    <div class="fab" onclick="window.app.openCreatePost()">+</div>

    <div class="sidebar">
        <h2 class="desk-label logo-text-small">Haskin</h2>
        <div class="nav-item active" onclick="window.ui.nav('feed')">üè† –õ–µ–Ω—Ç–∞</div>
        <div class="nav-item" onclick="window.ui.nav('market')">üõí –†—ã–Ω–æ–∫</div>
        <div class="nav-item" onclick="window.ui.nav('groups')">üë• –ì—Ä—É–ø–ø—ã</div>
        <div class="nav-item" onclick="window.ui.nav('chats')">üí¨ –ß–∞—Ç—ã</div>
        <div class="nav-item" onclick="window.ui.nav('rich')">üèÜ –¢–æ–ø</div>
        <div class="nav-item" onclick="window.ui.nav('profile')">üë§ –ü—Ä–æ—Ñ–∏–ª—å</div>
        <div class="nav-item hidden" id="nav-admin" onclick="window.ui.nav('admin')">üõ°Ô∏è –ê–¥–º–∏–Ω</div>
    </div>

    <div class="main">
        <div id="view-feed" class="view active"><h2 class="view-title">–õ–µ–Ω—Ç–∞</h2><div id="feed-content"></div></div>
        <div id="view-market" class="view">
            <h2 class="view-title" style="color:var(--gold-color)">–†—ã–Ω–æ–∫</h2>
            <div class="tabs">
                <button class="tab active" onclick="window.market.tab('cases')">–ö–µ–π—Å—ã</button>
                <button class="tab" onclick="window.market.tab('market')">–ë–∏—Ä–∂–∞</button>
                <button class="tab" onclick="window.market.tab('inventory')">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
            </div>
            <div id="market-content" class="market-grid"></div>
        </div>
        <div id="view-groups" class="view"><h2>–ì—Ä—É–ø–ø—ã</h2><button class="action-btn" onclick="document.getElementById('create-group-modal').classList.remove('hidden')">–°–æ–∑–¥–∞—Ç—å</button><div id="groups-list"></div></div>
        <div id="view-chats" class="view"><h2>–ß–∞—Ç—ã</h2><div id="chats-list"></div></div>
        <div id="view-rich" class="view"><h2>–¢–æ–ø –ë–æ–≥–∞—á–µ–π</h2><div id="rich-list"></div></div>
        <div id="view-profile" class="view"><div id="profile-head"></div><div id="profile-posts"></div></div>
        <div id="view-admin" class="view">
            <h2>–ê–¥–º–∏–Ω–∫–∞</h2>
            <div class="tabs">
                <button class="tab active" onclick="window.admin.tab('users')">–Æ–∑–µ—Ä—ã</button>
                <button class="tab" onclick="window.admin.tab('mod')">–ü–æ—Å—Ç—ã</button>
            </div>
            <div id="adm-content"></div>
        </div>
    </div>
</div>

<div id="view-chat-room" class="full-screen-view hidden">
    <div class="chat-header">
        <button onclick="window.ui.nav('chats')" class="back-btn">‚Üê</button>
        <b id="chat-title">User</b>
    </div>
    <div id="msg-container" class="msg-area"></div>
    <div class="chat-input-bar">
        <button id="game-btn" class="mic-btn" onclick="window.game.openCreate()">üé≤</button>
        <label class="attach-btn">üìé<input type="file" hidden accept="image/*" onchange="window.app.handleChatImg(this)"></label>
        <input id="msg-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
        <button class="action-btn" onclick="window.app.sendMsg()">‚û§</button>
    </div>
</div>

<script type="module" src="app.js"></script>
</body>
</html>
